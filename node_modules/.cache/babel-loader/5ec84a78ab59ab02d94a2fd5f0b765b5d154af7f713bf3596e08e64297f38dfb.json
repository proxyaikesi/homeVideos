{"ast":null,"code":"import { ref, reactive, onMounted } from \"vue\";\nimport CustomVideo from './CustomVideo.vue';\nexport default {\n  components: {\n    CustomVideo\n  },\n  setup() {\n    // 假设 videos 是从后端接收到的视频数据数组\n    const videos = reactive([{\n      id: 1,\n      src: \"http://localhost:3000/video/1716110835939_TikSave.io_7332553251478310152-hd.mp4.mp4\",\n      title: \"Video 1\"\n    }, {\n      id: 2,\n      src: \"http://localhost:3000/video/1716101838317_TikSave.io_7341508786114383122-hd.mp4.mp4\",\n      title: \"Video 2\"\n    }, {\n      id: 3,\n      src: \"http://localhost:3000/video/1716110864416_TikSave.io-7341064610973322514-(1080p).mp4.mp4\",\n      title: \"Video 3\"\n    }, {\n      id: 4,\n      src: \"http://localhost:3000/video/1716110877916_TikSave.io-7353063476912196885-(1080p).mp4.mp4\",\n      title: \"Video 4\"\n    }, {\n      id: 4,\n      src: \"http://localhost:3000/video/1716110877916_TikSave.io-7353063476912196885-(1080p).mp4.mp4\",\n      title: \"Video 4\"\n    }, {\n      id: 4,\n      src: \"http://localhost:3000/video/1716110877916_TikSave.io-7353063476912196885-(1080p).mp4.mp4\",\n      title: \"Video 4\"\n    }, {\n      id: 4,\n      src: \"http://localhost:3000/video/1716110877916_TikSave.io-7353063476912196885-(1080p).mp4.mp4\",\n      title: \"Video 4\"\n    }, {\n      id: 4,\n      src: \"http://localhost:3000/video/1716110877916_TikSave.io-7353063476912196885-(1080p).mp4.mp4\",\n      title: \"Video 4\"\n    }\n    // 其他视频数据...\n    ]);\n\n    // 可见的视频列表\n    const visibleVideos = ref([]);\n\n    // 每次加载的视频数量\n    const loadCount = 5;\n\n    // 当前加载的视频索引\n    let currentIndex = 0;\n\n    // 根据 currentIndex 更新可见视频列表\n    const updateVisibleVideos = () => {\n      visibleVideos.value = videos.slice(currentIndex, currentIndex + loadCount);\n    };\n\n    // 初始化时加载视频列表\n    onMounted(() => {\n      updateVisibleVideos();\n    });\n\n    // 处理滚动事件\n    const handleScroll = () => {\n      const container = document.querySelector(\".video-container\");\n      if (!container) return;\n      const {\n        scrollTop,\n        scrollHeight,\n        clientHeight\n      } = container;\n      if (scrollTop + clientHeight >= scrollHeight) {\n        // 到达底部时加载更多视频\n        currentIndex += loadCount;\n        updateVisibleVideos();\n      }\n    };\n    return {\n      visibleVideos,\n      handleScroll\n    };\n  }\n};","map":{"version":3,"names":["ref","reactive","onMounted","CustomVideo","components","setup","videos","id","src","title","visibleVideos","loadCount","currentIndex","updateVisibleVideos","value","slice","handleScroll","container","document","querySelector","scrollTop","scrollHeight","clientHeight"],"sources":["D:\\vue3\\video\\src\\components\\index.vue"],"sourcesContent":["<template>\r\n  <div class=\"video-container\" @scroll=\"handleScroll\">\r\n    <div v-for=\"(video, index) in visibleVideos\" :key=\"video.id\" class=\"video-item\">\r\n      <CustomVideo :src=\"video.src\" :title=\"video.title\"></CustomVideo>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, onMounted } from \"vue\";\r\nimport CustomVideo from './CustomVideo.vue'\r\nexport default {\r\n  components: {\r\n    CustomVideo,\r\n  },\r\n  setup() {\r\n    // 假设 videos 是从后端接收到的视频数据数组\r\n    const videos = reactive([\r\n      { id: 1, src: \"http://localhost:3000/video/1716110835939_TikSave.io_7332553251478310152-hd.mp4.mp4\", title: \"Video 1\" },\r\n      { id: 2, src: \"http://localhost:3000/video/1716101838317_TikSave.io_7341508786114383122-hd.mp4.mp4\", title: \"Video 2\" },\r\n      { id: 3, src: \"http://localhost:3000/video/1716110864416_TikSave.io-7341064610973322514-(1080p).mp4.mp4\", title: \"Video 3\" },\r\n      { id: 4, src: \"http://localhost:3000/video/1716110877916_TikSave.io-7353063476912196885-(1080p).mp4.mp4\", title: \"Video 4\" },\r\n      { id: 4, src: \"http://localhost:3000/video/1716110877916_TikSave.io-7353063476912196885-(1080p).mp4.mp4\", title: \"Video 4\" },\r\n      { id: 4, src: \"http://localhost:3000/video/1716110877916_TikSave.io-7353063476912196885-(1080p).mp4.mp4\", title: \"Video 4\" },\r\n      { id: 4, src: \"http://localhost:3000/video/1716110877916_TikSave.io-7353063476912196885-(1080p).mp4.mp4\", title: \"Video 4\" },\r\n      { id: 4, src: \"http://localhost:3000/video/1716110877916_TikSave.io-7353063476912196885-(1080p).mp4.mp4\", title: \"Video 4\" },\r\n      // 其他视频数据...\r\n    ]);\r\n\r\n    // 可见的视频列表\r\n    const visibleVideos = ref([]);\r\n\r\n    // 每次加载的视频数量\r\n    const loadCount = 5;\r\n\r\n    // 当前加载的视频索引\r\n    let currentIndex = 0;\r\n\r\n    // 根据 currentIndex 更新可见视频列表\r\n    const updateVisibleVideos = () => {\r\n      visibleVideos.value = videos.slice(currentIndex, currentIndex + loadCount);\r\n    };\r\n\r\n    // 初始化时加载视频列表\r\n    onMounted(() => {\r\n      updateVisibleVideos();\r\n    });\r\n\r\n    // 处理滚动事件\r\n    const handleScroll = () => {\r\n      const container = document.querySelector(\".video-container\");\r\n      if (!container) return;\r\n\r\n      const { scrollTop, scrollHeight, clientHeight } = container;\r\n      if (scrollTop + clientHeight >= scrollHeight) {\r\n        // 到达底部时加载更多视频\r\n        currentIndex += loadCount;\r\n        updateVisibleVideos();\r\n      }\r\n    };\r\n\r\n    return {\r\n      visibleVideos,\r\n      handleScroll,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.video-container {\r\n  height: 100%;\r\n  overflow-y: auto;\r\n}\r\n\r\n.video-item {\r\n  margin-bottom: 20px;\r\n}\r\n</style>\r\n"],"mappings":"AASA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAQ,QAAS,KAAK;AAC9C,OAAOC,WAAU,MAAO,mBAAkB;AAC1C,eAAe;EACbC,UAAU,EAAE;IACVD;EACF,CAAC;EACDE,KAAKA,CAAA,EAAG;IACN;IACA,MAAMC,MAAK,GAAIL,QAAQ,CAAC,CACtB;MAAEM,EAAE,EAAE,CAAC;MAAEC,GAAG,EAAE,qFAAqF;MAAEC,KAAK,EAAE;IAAU,CAAC,EACvH;MAAEF,EAAE,EAAE,CAAC;MAAEC,GAAG,EAAE,qFAAqF;MAAEC,KAAK,EAAE;IAAU,CAAC,EACvH;MAAEF,EAAE,EAAE,CAAC;MAAEC,GAAG,EAAE,0FAA0F;MAAEC,KAAK,EAAE;IAAU,CAAC,EAC5H;MAAEF,EAAE,EAAE,CAAC;MAAEC,GAAG,EAAE,0FAA0F;MAAEC,KAAK,EAAE;IAAU,CAAC,EAC5H;MAAEF,EAAE,EAAE,CAAC;MAAEC,GAAG,EAAE,0FAA0F;MAAEC,KAAK,EAAE;IAAU,CAAC,EAC5H;MAAEF,EAAE,EAAE,CAAC;MAAEC,GAAG,EAAE,0FAA0F;MAAEC,KAAK,EAAE;IAAU,CAAC,EAC5H;MAAEF,EAAE,EAAE,CAAC;MAAEC,GAAG,EAAE,0FAA0F;MAAEC,KAAK,EAAE;IAAU,CAAC,EAC5H;MAAEF,EAAE,EAAE,CAAC;MAAEC,GAAG,EAAE,0FAA0F;MAAEC,KAAK,EAAE;IAAU;IAC3H;IAAA,CACD,CAAC;;IAEF;IACA,MAAMC,aAAY,GAAIV,GAAG,CAAC,EAAE,CAAC;;IAE7B;IACA,MAAMW,SAAQ,GAAI,CAAC;;IAEnB;IACA,IAAIC,YAAW,GAAI,CAAC;;IAEpB;IACA,MAAMC,mBAAkB,GAAIA,CAAA,KAAM;MAChCH,aAAa,CAACI,KAAI,GAAIR,MAAM,CAACS,KAAK,CAACH,YAAY,EAAEA,YAAW,GAAID,SAAS,CAAC;IAC5E,CAAC;;IAED;IACAT,SAAS,CAAC,MAAM;MACdW,mBAAmB,CAAC,CAAC;IACvB,CAAC,CAAC;;IAEF;IACA,MAAMG,YAAW,GAAIA,CAAA,KAAM;MACzB,MAAMC,SAAQ,GAAIC,QAAQ,CAACC,aAAa,CAAC,kBAAkB,CAAC;MAC5D,IAAI,CAACF,SAAS,EAAE;MAEhB,MAAM;QAAEG,SAAS;QAAEC,YAAY;QAAEC;MAAa,IAAIL,SAAS;MAC3D,IAAIG,SAAQ,GAAIE,YAAW,IAAKD,YAAY,EAAE;QAC5C;QACAT,YAAW,IAAKD,SAAS;QACzBE,mBAAmB,CAAC,CAAC;MACvB;IACF,CAAC;IAED,OAAO;MACLH,aAAa;MACbM;IACF,CAAC;EACH;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}