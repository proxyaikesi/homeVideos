{"ast":null,"code":"import { RouterView } from 'vue-router';\nimport { videoPlay } from 'vue3-video-play';\nimport 'vue3-video-play/dist/style.css';\nimport Video from './video.vue';\nimport { onBeforeMount, getCurrentInstance, ref, reactive, onUpdated, onMounted, nextTick } from \"vue\";\nimport axios from 'axios';\nexport default {\n  components: {\n    videoPlay,\n    Video,\n    RouterView\n  },\n  setup() {\n    let videolist = reactive({\n      arrList: [],\n      // 所有视频信息\n      newArr: [],\n      // 默认5条累加\n      everyTime: 5\n    });\n    onBeforeMount(() => {\n      fnList();\n    });\n    function fnList() {\n      axios.post('http://localhost:3000/videoManage', {\n        params: {\n          // id: store.state.userInfo._id\n        }\n      }).then(el => {\n        videolist.arrList = el.data.item.sort(() => 0.5 - Math.random());\n        console.log(videolist.arrList);\n        console.log('el', el);\n        addList(5);\n      });\n    }\n    function addList(nums) {\n      let num = 0;\n      if (videolist.arrList.length >= 5) {\n        videolist.newArr = videolist.arrList.slice(0, videolist.everyTime);\n      }\n    }\n    const fullPageContainer = ref();\n    const fullPageaa = ref();\n    const fullpage = reactive({\n      current: 1,\n      // 当前的页面编号\n      isScrolling: false,\n      // 是否在滚动,是为了防止滚动多页，需要通过一个变量来控制是否滚动S\n      deltaY: 0 //返回鼠标滚轮的垂直滚动量，保存的鼠标滚动事件的deleteY,用来判断是往下还是往上滚\n    });\n\n    const one = () => {\n      videolist.everyTime += 5;\n      addList();\n    };\n    const next = () => {\n      // 往下切换\n      let len = videolist.newArr.length; // 页面的个数\n      if (fullpage.current + 1 <= len) {\n        // 如果当前页面编号+1 小于总个数，则可以执行向下滑动\n        fullpage.current += 1; // 页面+1\n        console.log('页数', fullpage.current);\n        move(fullpage.current); // 执行切换\n      }\n    };\n\n    const pre = () => {\n      // 往上切换\n      if (fullpage.current - 1 > 0) {\n        // 如果当前页面编号-1 大于0，则可以执行向下滑动\n        fullpage.current -= 1; // 页面+1\n        console.log('页数', fullpage.current);\n        move(fullpage.current); // 执行切换\n      }\n    };\n\n    const move = index => {\n      fullpage.isScrolling = true; // 为了防止滚动多页，需要通过一个变量来控制是否滚动\n      directToMove(index); //执行滚动\n      setTimeout(() => {\n        //这里的动画是1s执行完，使用setTimeout延迟1s后解锁\n        fullpage.isScrolling = false;\n      }, 1000);\n    };\n    const directToMove = index => {\n      let height = fullPageaa.value.clientHeight; //获取屏幕的宽度c\n      // let scrollPage = this.$refs[\"fullPageContainer\"]; // 获取执行tarnsform的元素\n      let scrollPage = fullPageContainer.value; // 获取执行tarnsform的元素\n      let scrollHeight; // 计算滚动的告诉，是往上滚还往下滚\n      scrollHeight = -(index - 1) * height + \"px\";\n      scrollPage.style.transform = `translateY(${scrollHeight})`;\n      fullpage.current = index;\n    };\n    const mouseWheelHandle = event => {\n      // 监听鼠标监听\n      // 添加冒泡阻止\n      let evt = event || window.event;\n      if (evt.stopPropagation) {\n        evt.stopPropagation();\n      } else {\n        evt.returnValue = false;\n      }\n      if (fullpage.isScrolling) {\n        // 判断是否可以滚动\n        return false;\n      }\n      let e = event.originalEvent || event;\n      fullpage.deltaY = e.deltaY || e.detail; // Firefox使用detail\n      if (fullpage.deltaY > 0) {\n        next();\n      } else if (fullpage.deltaY < 0) {\n        pre();\n      }\n    };\n    return {\n      fullpage,\n      mouseWheelHandle,\n      videolist,\n      directToMove,\n      directToMove,\n      move,\n      pre,\n      one,\n      next,\n      fullPageContainer,\n      fullPageaa\n    };\n  }\n};","map":{"version":3,"names":["RouterView","videoPlay","Video","onBeforeMount","getCurrentInstance","ref","reactive","onUpdated","onMounted","nextTick","axios","components","setup","videolist","arrList","newArr","everyTime","fnList","post","params","then","el","data","item","sort","Math","random","console","log","addList","nums","num","length","slice","fullPageContainer","fullPageaa","fullpage","current","isScrolling","deltaY","one","next","len","move","pre","index","directToMove","setTimeout","height","value","clientHeight","scrollPage","scrollHeight","style","transform","mouseWheelHandle","event","evt","window","stopPropagation","returnValue","e","originalEvent","detail"],"sources":["D:\\vue3\\video\\src\\components\\index.vue"],"sourcesContent":["<template>\r\n  <div class=\"h1\" @click=\"one\">点我\r\n    <input type=\"text\">\r\n    <router-link to=\"/register\" active-class=\"active\">皮蛋编程</router-link>\r\n  </div>\r\n  <div class=\"fullPage\" ref=\"fullPageaa\">\r\n    <div class=\"fullPageContainer\" ref=\"fullPageContainer\" @mousewheel=\"mouseWheelHandle\"\r\n      @DOMMouseScroll=\"mouseWheelHandle\">\r\n        <Video v-for=\"(item, index) in videolist.newArr\" :inNum=\"index + 1\" :isplay=\"fullpage.current\"\r\n          :mp4Url=\"item.file_name\">\r\n        \r\n\r\n        </Video>\r\n        <!-- <h2 style=\"color: brown; font-size: 50px;\">{{  videolist.newArr }}</h2> -->\r\n\r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n  \r\n<script>\r\nimport { RouterView } from 'vue-router';\r\nimport { videoPlay } from 'vue3-video-play'\r\nimport 'vue3-video-play/dist/style.css'\r\nimport Video from './video.vue'\r\nimport { onBeforeMount, getCurrentInstance, ref, reactive, onUpdated, onMounted, nextTick, } from \"vue\";\r\n\r\nimport axios from 'axios'\r\nexport default ({\r\n  components: {\r\n    videoPlay,\r\n    Video,\r\n    RouterView\r\n  },\r\n  setup() {\r\n    let videolist = reactive({\r\n      arrList: [],  // 所有视频信息\r\n      newArr: [], // 默认5条累加\r\n      everyTime: 5\r\n    })\r\n    onBeforeMount(() => {\r\n      fnList()\r\n\r\n    });\r\n    function fnList() {\r\n      axios.post('http://localhost:3000/videoManage',{\r\n        params: {\r\n                // id: store.state.userInfo._id\r\n            }\r\n      }).then((el) => {\r\n        videolist.arrList = el.data.item.sort(()=> 0.5 - Math.random())\r\n        console.log( videolist.arrList);\r\n        console.log( 'el',el);\r\n        addList(5)\r\n      })\r\n    }\r\n    function addList(nums) {\r\n      let num = 0\r\n\r\n      if (videolist.arrList.length >= 5) {\r\n        \r\n        videolist.newArr = videolist.arrList.slice(0, videolist.everyTime)\r\n      }\r\n\r\n    }\r\n    const fullPageContainer = ref()\r\n    const fullPageaa = ref()\r\n    const fullpage = reactive({\r\n      current: 1, // 当前的页面编号\r\n      isScrolling: false, // 是否在滚动,是为了防止滚动多页，需要通过一个变量来控制是否滚动S\r\n      deltaY: 0 //返回鼠标滚轮的垂直滚动量，保存的鼠标滚动事件的deleteY,用来判断是往下还是往上滚\r\n    })\r\n    const one = () => {\r\n      videolist.everyTime += 5\r\n      addList()\r\n    }\r\n\r\n    const next = () => { // 往下切换\r\n      let len = videolist.newArr.length; // 页面的个数\r\n      if (fullpage.current + 1 <= len) { // 如果当前页面编号+1 小于总个数，则可以执行向下滑动\r\n        fullpage.current += 1; // 页面+1\r\n        console.log('页数', fullpage.current);\r\n        move(fullpage.current); // 执行切换\r\n\r\n      }\r\n    }\r\n    const pre = () => {// 往上切换\r\n      if (fullpage.current - 1 > 0) { // 如果当前页面编号-1 大于0，则可以执行向下滑动\r\n        fullpage.current -= 1;// 页面+1\r\n        console.log('页数', fullpage.current);\r\n        move(fullpage.current);// 执行切换\r\n      }\r\n    }\r\n    const move = (index) => {\r\n      fullpage.isScrolling = true; // 为了防止滚动多页，需要通过一个变量来控制是否滚动\r\n      directToMove(index); //执行滚动\r\n      setTimeout(() => {  //这里的动画是1s执行完，使用setTimeout延迟1s后解锁\r\n        fullpage.isScrolling = false;\r\n      }, 1000);\r\n    }\r\n    const directToMove = (index) => {\r\n      let height = fullPageaa.value.clientHeight; //获取屏幕的宽度c\r\n      // let scrollPage = this.$refs[\"fullPageContainer\"]; // 获取执行tarnsform的元素\r\n      let scrollPage = fullPageContainer.value // 获取执行tarnsform的元素\r\n      let scrollHeight; // 计算滚动的告诉，是往上滚还往下滚\r\n      scrollHeight = -(index - 1) * height + \"px\";\r\n      scrollPage.style.transform = `translateY(${scrollHeight})`;\r\n      fullpage.current = index;\r\n    }\r\n    const mouseWheelHandle = (event) => { // 监听鼠标监听\r\n      // 添加冒泡阻止\r\n      let evt = event || window.event;\r\n      if (evt.stopPropagation) {\r\n        evt.stopPropagation();\r\n      } else {\r\n        evt.returnValue = false;\r\n      }\r\n      if (fullpage.isScrolling) { // 判断是否可以滚动\r\n        return false;\r\n      }\r\n      let e = event.originalEvent || event;\r\n      fullpage.deltaY = e.deltaY || e.detail; // Firefox使用detail\r\n      if (fullpage.deltaY > 0) {\r\n        next();\r\n      } else if (fullpage.deltaY < 0) {\r\n        pre();\r\n      }\r\n    }\r\n\r\n\r\n\r\n\r\n    return {\r\n      fullpage, mouseWheelHandle, videolist,\r\n      directToMove, directToMove, move, pre, one, next, fullPageContainer, fullPageaa\r\n    }\r\n  },\r\n})\r\n\r\n</script>\r\n  \r\n<style  lang=\"scss\">\r\n\r\n.h1 {\r\n  color: #fff;\r\n  position: absolute;\r\n  z-index: 9999;\r\n}\r\n\r\n.fullPage {\r\n  height: 830px; //一定要设置，保证占满\r\n  overflow: hidden; //一定要设置，多余的先隐藏ss\r\n  font-size: 0;\r\n\r\n  // background: red;\r\n}\r\n\r\n.fullPageContainer {\r\n  width: 100%;\r\n  height: 830px; //一定要设置，保证占满\r\n\r\n  transition: all linear 0.3s;\r\n}\r\n\r\n.section {\r\n  width: 100%;\r\n  height: 100vh;\r\n  background-position: center center;\r\n  background-repeat: no-repeat;\r\n}\r\n\r\n\r\n.section1 .secction1-content {\r\n  color: #fff;\r\n  text-align: center;\r\n  position: absolute;\r\n  top: 40%;\r\n  right: 0;\r\n  left: 0;\r\n}\r\n\r\n.secction1-content h1 {\r\n  font-size: 40px;\r\n  padding-bottom: 30px;\r\n}\r\n\r\n.secction1-content p {\r\n  font-size: 20px;\r\n}\r\n</style>\r\n  "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}