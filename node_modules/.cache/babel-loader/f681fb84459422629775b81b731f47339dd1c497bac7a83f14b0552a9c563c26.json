{"ast":null,"code":"import { onBeforeMount, ref, reactive, onMounted } from \"vue\";\nimport axios from 'axios';\nimport Video from './video.vue';\nexport default {\n  components: {\n    Video\n  },\n  setup() {\n    const fullPageContainer = ref(null);\n    const fullPage = ref(null);\n    const videolist = reactive({\n      arrList: [],\n      currentVideoIndex: 0,\n      visibleVideos: []\n    });\n    onBeforeMount(() => {\n      fnList();\n    });\n    onMounted(() => {\n      if (fullPageContainer.value) {\n        fullPageContainer.value.addEventListener('wheel', mouseWheelHandle, {\n          passive: true\n        });\n      } else {\n        console.error('fullPageContainer is null');\n      }\n    });\n    function fnList() {\n      axios.get('http://localhost:3000/getVideo').then(res => {\n        videolist.arrList = res.data.item.sort(() => 0.5 - Math.random());\n        updateVisibleVideos();\n      });\n    }\n    function updateVisibleVideos() {\n      const startIndex = videolist.currentVideoIndex;\n      const endIndex = Math.min(startIndex + 5, videolist.arrList.length);\n      videolist.visibleVideos = videolist.arrList.slice(startIndex, endIndex);\n    }\n    const mouseWheelHandle = event => {\n      if (event.deltaY > 0) {\n        scrollDown();\n      } else {\n        scrollUp();\n      }\n    };\n    function scrollDown() {\n      if (fullPageContainer.value) {\n        videolist.currentVideoIndex = (videolist.currentVideoIndex + 1) % videolist.arrList.length;\n        updateVisibleVideos();\n        directToMove(videolist.currentVideoIndex);\n      }\n    }\n    function scrollUp() {\n      if (fullPageContainer.value) {\n        videolist.currentVideoIndex = (videolist.currentVideoIndex - 1 + videolist.arrList.length) % videolist.arrList.length;\n        updateVisibleVideos();\n        directToMove(videolist.currentVideoIndex);\n      }\n    }\n    function directToMove(index) {\n      if (fullPageContainer.value && fullPage.value) {\n        const height = fullPage.value.clientHeight;\n        const scrollPage = fullPageContainer.value;\n        const scrollHeight = -(index * height) + 'px';\n        scrollPage.style.transform = `translateY(${scrollHeight})`;\n      }\n    }\n    return {\n      fullPageContainer,\n      videolist\n    };\n  }\n};","map":{"version":3,"names":["onBeforeMount","ref","reactive","onMounted","axios","Video","components","setup","fullPageContainer","fullPage","videolist","arrList","currentVideoIndex","visibleVideos","fnList","value","addEventListener","mouseWheelHandle","passive","console","error","get","then","res","data","item","sort","Math","random","updateVisibleVideos","startIndex","endIndex","min","length","slice","event","deltaY","scrollDown","scrollUp","directToMove","index","height","clientHeight","scrollPage","scrollHeight","style","transform"],"sources":["D:\\vue3\\video\\src\\components\\index.vue"],"sourcesContent":["<template>\r\n  <div class=\"box\">\r\n    <div class=\"fullPage\" ref=\"fullPage\">\r\n      <!-- fullPageContainer容器用于包裹视频，监听滚动事件 -->\r\n      <div class=\"fullPageContainer\" ref=\"fullPageContainer\" @wheel.passive=\"mouseWheelHandle\">\r\n        <!-- 使用v-for循环渲染visibleVideos中的视频 -->\r\n        <Video v-for=\"(item, index) in videolist.visibleVideos\" :key=\"index\" :inNum=\"index\" :isplay=\"currentVideoIndex === index\"\r\n          :mp4Url=\"item.file_name\"></Video>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { onBeforeMount, ref, reactive, onMounted } from \"vue\";\r\nimport axios from 'axios';\r\nimport Video from './video.vue';\r\n\r\nexport default {\r\n  components: {\r\n    Video,\r\n  },\r\n  setup() {\r\n    const fullPageContainer = ref(null);\r\n    const fullPage = ref(null);\r\n    const videolist = reactive({\r\n      arrList: [],\r\n      currentVideoIndex: 0,\r\n      visibleVideos: []\r\n    });\r\n\r\n    onBeforeMount(() => {\r\n      fnList();\r\n    });\r\n\r\n    onMounted(() => {\r\n      if (fullPageContainer.value) {\r\n        fullPageContainer.value.addEventListener('wheel', mouseWheelHandle, { passive: true });\r\n      } else {\r\n        console.error('fullPageContainer is null');\r\n      }\r\n    });\r\n\r\n    function fnList() {\r\n      axios.get('http://localhost:3000/getVideo').then((res) => {\r\n        videolist.arrList = res.data.item.sort(() => 0.5 - Math.random());\r\n        updateVisibleVideos();\r\n      });\r\n    }\r\n\r\n    function updateVisibleVideos() {\r\n      const startIndex = videolist.currentVideoIndex;\r\n      const endIndex = Math.min(startIndex + 5, videolist.arrList.length);\r\n      videolist.visibleVideos = videolist.arrList.slice(startIndex, endIndex);\r\n    }\r\n\r\n    const mouseWheelHandle = (event) => {\r\n      if (event.deltaY > 0) {\r\n        scrollDown();\r\n      } else {\r\n        scrollUp();\r\n      }\r\n    }\r\n\r\n    function scrollDown() {\r\n      if (fullPageContainer.value) {\r\n      videolist.currentVideoIndex = (videolist.currentVideoIndex + 1) % videolist.arrList.length;\r\n      updateVisibleVideos();\r\n      directToMove(videolist.currentVideoIndex);\r\n    }\r\n    }\r\n\r\n    function scrollUp() {\r\n      if (fullPageContainer.value) {\r\n      videolist.currentVideoIndex = (videolist.currentVideoIndex - 1 + videolist.arrList.length) % videolist.arrList.length;\r\n      updateVisibleVideos();\r\n      directToMove(videolist.currentVideoIndex);\r\n      }\r\n    }\r\n\r\n    function directToMove(index) {\r\n      if (fullPageContainer.value && fullPage.value) {\r\n      const height = fullPage.value.clientHeight;\r\n      const scrollPage = fullPageContainer.value;\r\n      const scrollHeight = -(index * height) + 'px';\r\n      scrollPage.style.transform = `translateY(${scrollHeight})`;\r\n      }\r\n    }\r\n\r\n    return {\r\n      fullPageContainer,\r\n      videolist\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n\r\n<style scoped lang=\"scss\">\r\n.h1 {\r\n  color: #fff;\r\n  position: absolute;\r\n  z-index: 9999;\r\n}\r\n\r\n.main_h {\r\n  position: relative;\r\n  font-size: 50px;\r\n  color: #fff;\r\n  z-index: 9999;\r\n}\r\n\r\n.box {\r\n  height: 90vh;\r\n  top: 70px;\r\n  flex-direction: column;\r\n  flex: 1;\r\n  display: flex;\r\n  position: relative;\r\n  overflow: hidden;\r\n  background: url('../../public/wallpaper.png');\r\n}\r\n\r\n// .fullPage {\r\n//   height: 100vh; //一定要设置，保证占满\r\n//   overflow: hidden; //一定要设置，多余的先隐藏ss\r\n//   background: url('../../public/wallpaper.png');\r\n// }\r\n.fullPage {\r\n  position: absolute;\r\n  left: 0;\r\n  top: calc(0% + 0px);\r\n  width: 100%;\r\n  height: calc(100% - 0px);\r\n  overflow: visible;\r\n  padding-left: 0;\r\n  padding-right: 68px;\r\n  min-height: 455px;\r\n}\r\n\r\n.fullPageContainer {\r\n  width: 100%;\r\n  display: flex;\r\n\r\n  flex-direction: column;\r\n  height: 90vh;\r\n\r\n  // background:'./public/wallpaper.png' ;\r\n  background: #4947470a;\r\n  border-radius: 10px;\r\n  // background: url(\"./static/images/logo.png\");\r\n  transition: all linear 0.2s;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.section {\r\n  width: 100%;\r\n  height: 100vh;\r\n  background-position: center center;\r\n  background-repeat: no-repeat;\r\n}\r\n\r\n\r\n.section1 .secction1-content {\r\n  color: #fff;\r\n  text-align: center;\r\n  position: absolute;\r\n  top: 40%;\r\n  right: 0;\r\n  left: 0;\r\n}\r\n\r\n.secction1-content h1 {\r\n  font-size: 40px;\r\n  padding-bottom: 30px;\r\n}\r\n\r\n.secction1-content p {\r\n  font-size: 20px;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}